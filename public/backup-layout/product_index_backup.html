{% extends "admin_base.html" %}

{% block link %}
{% endblock %}

{% block title %}ניהול מוצרים{% endblock %}

{% block body %}



<!--Export to text file-->
<div class="container mt-4 mb-4">

    {% for error in textErrors %}
    <div class="text-danger">
        <span>* </span>{{error}}
    </div>
    {% endfor %}


    <a href="#export" data-toggle="collapse" class="btn btn-light">
        ייצא לקובץ טקסט
        <svg class="bi bi-box-arrow-in-down" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor"
            xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd"
                d="M4.646 8.146a.5.5 0 01.708 0L8 10.793l2.646-2.647a.5.5 0 01.708.708l-3 3a.5.5 0 01-.708 0l-3-3a.5.5 0 010-.708z"
                clip-rule="evenodd" />
            <path fill-rule="evenodd" d="M8 1a.5.5 0 01.5.5v9a.5.5 0 01-1 0v-9A.5.5 0 018 1z" clip-rule="evenodd" />
            <path fill-rule="evenodd"
                d="M1.5 13.5A1.5 1.5 0 003 15h10a1.5 1.5 0 001.5-1.5v-8A1.5 1.5 0 0013 4h-1.5a.5.5 0 000 1H13a.5.5 0 01.5.5v8a.5.5 0 01-.5.5H3a.5.5 0 01-.5-.5v-8A.5.5 0 013 5h1.5a.5.5 0 000-1H3a1.5 1.5 0 00-1.5 1.5v8z"
                clip-rule="evenodd" />
        </svg>
    </a>

    <form action="/admin/products/export_txt" method="POST">
        <div id="export" class="main-container collapse mb-4 col-12 col-lg-4 ">
            <div class="input-group mb-4 mt-4">
                <input type="text" name="txt_file_name" class="form-control" placeholder="שם הקובץ">
            </div>
            <button class="btn btn-lg btn-dark btn-block w-50" type="submit">ייצא</button>
        </div>
    </form>

</div>





<!--Products table-->
<div class="container table-responsive">
    <table class="table table-hover">
        <thead>
            <tr class="bg-dark text-white">
                <th scope="col">מזהה</th>
                <th scope="col">קטגוריה</th>
                <th scope="col">שם המוצר</th>
                <th scope="col">מחיר</th>
                <th scope="col">כמות</th>
                <th scope="col">תאריך העלאה</th>
                <th scope="col" class="text-center">פעולות</th>
            </tr>
        </thead>
        <tbody>

            {% for p in products %}
            <!--Product-->
            <tr>
                <th scope="row">{{p.product_id}}</th>
                <td>{{p.display_name}}</td>
                <td>{{p.product_name}}</td>
                <td>{{p.product_price}}</td>
                <td>{{p.product_quantity}}</td>
                <td>{{p.uploaded_at}}</td>
                <!--Product row buttons-->
                <td>
                    <div class="d-flex justify-content-end">
                        <form action="/admin/products/delete/{{p.product_id}}" method="POST">
                            <button class="btn btn-dark mr-2" name="deleteProduct">הסרה</button>
                        </form>
                        <a href="/admin/products/edit/{{p.product_id}}" class="btn btn-dark mr-2">עדכון</a>
                        <div class="d-flex align-items-end">
                            <a href="#product_info{{p.product_id}}" class="btn btn-default" data-toggle="collapse">
                                <svg class="bi bi-chevron-compact-down" width="1em" height="1em" viewBox="0 0 16 16"
                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd"
                                        d="M1.553 6.776a.5.5 0 01.67-.223L8 9.44l5.776-2.888a.5.5 0 11.448.894l-6 3a.5.5 0 01-.448 0l-6-3a.5.5 0 01-.223-.67z"
                                        clip-rule="evenodd" />
                                </svg>
                            </a>
                        </div>
                    </div>
                </td>
            </tr>
            <tr id="product_info{{p.product_id}}" class="main-container collapse">
                <td colspan="7">
                    <div class="d-flex">
                        <div class="w-25">
                            <img src="/images/{{p.product_img}}" alt="{{p.display_name}}" class="img-thumbnail">
                        </div>
                        <div class="pl-4">
                            <span class="h6">תיאור המוצר</span>
                            <div>
                                {{p.description}}
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            {% endfor %}


        </tbody>
    </table>
</div>



{% endblock %}